LAMMPS (29 Sep 2021 - Update 2)
# 3d Lennard-Jones melt

variable    ave_one equal 500
variable    nintervals index 40
variable    mcmaxdispl index 0.1
variable    prodlength equal ${ave_one}*${nintervals}
variable    prodlength equal 500*${nintervals}
variable    prodlength equal 500*40
variable    temperature index 0.1

units		lj
atom_style	atomic

lattice		sc 0.8442
Lattice spacing in x,y,z = 1.0580793 1.0580793 1.0580793
region		box block 0 5 0 5 0 5
create_box	1 box
Created orthogonal box = (0.0000000 0.0000000 0.0000000) to (5.2903965 5.2903965 5.2903965)
  1 by 1 by 1 MPI processor grid
create_atoms	1 box
Created 125 atoms
  using lattice units in orthogonal box = (0.0000000 0.0000000 0.0000000) to (5.2903965 5.2903965 5.2903965)
  create_atoms CPU = 0.000 seconds
mass		1 1.0

velocity	all create 3.0 87287

pair_style	lj/smooth 3.0 3.5
pair_coeff	1 1 1.0 1.0

neighbor	0.3 bin
neigh_modify	every 20 delay 0 check no

fix		1 all nve

thermo		500

thermo_style	custom step temp etotal press
run		2500
Neighbor list info ...
  update every 20 steps, delay 0 steps, check no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.8
  ghost atom cutoff = 3.8
  binsize = 1.9, bins = 3 3 3
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/smooth, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 2.635 | 2.635 | 2.635 Mbytes
Step Temp TotEng Press 
       0            3   -1.0476854    3.9138214 
     500    2.3754998   -1.0519801    8.0165648 
    1000    2.3915791   -1.0523855    7.9698354 
    1500    2.3160083   -1.0542784     8.343986 
    2000    2.2641375   -1.0525307    8.5995115 
    2500    2.2041144   -1.0538041    8.9278075 
Loop time of 1.20149 on 1 procs for 2500 steps with 125 atoms

Performance: 898885.173 tau/day, 2080.753 timesteps/s
99.6% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.0279     | 1.0279     | 1.0279     |   0.0 | 85.55
Neigh   | 0.1111     | 0.1111     | 0.1111     |   0.0 |  9.25
Comm    | 0.046922   | 0.046922   | 0.046922   |   0.0 |  3.91
Output  | 0.00014627 | 0.00014627 | 0.00014627 |   0.0 |  0.01
Modify  | 0.0071965  | 0.0071965  | 0.0071965  |   0.0 |  0.60
Other   |            | 0.008206   |            |       |  0.68

Nlocal:        125.000 ave         125 max         125 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:        1702.00 ave        1702 max        1702 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:        12022.0 ave       12022 max       12022 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 12022
Ave neighs/atom = 96.176000
Neighbor list builds = 125
Dangerous builds not checked

fix		isokin all temp/rescale 20 ${temperature} ${temperature} 0.02 1.0
fix		isokin all temp/rescale 20 0.1 ${temperature} 0.02 1.0
fix		isokin all temp/rescale 20 0.1 0.1 0.02 1.0

run		50000
Per MPI rank memory allocation (min/avg/max) = 2.636 | 2.636 | 2.636 Mbytes
Step Temp TotEng Press 
    2500    2.2041144   -1.0538041    8.9278075 
    3000   0.10889231    -6.523629   -3.6088954 
    3500   0.11056464   -6.5541562   -3.7066819 
    4000   0.10239585   -6.5862728   -4.0173768 
    4500   0.11621063   -6.5862373    -3.913053 
    5000   0.10570099   -6.6174668    -3.797674 
    5500   0.10021846   -6.6519382   -3.4208286 
    6000    0.1033901   -6.6848105   -3.2575399 
    6500   0.10483518   -6.7179882   -2.9811528 
    7000  0.098129015   -6.7510368   -3.2238828 
    7500   0.11229007   -6.8137226     -3.74805 
    8000   0.10562637   -6.8453674   -3.7672289 
    8500   0.10562219   -6.8453739   -3.7804918 
    9000   0.10877593   -6.8453485   -3.8499691 
    9500   0.10608477   -6.8457638   -3.8672034 
   10000   0.10643543   -6.8452919   -3.5881945 
   10500   0.10053086   -6.8453051   -3.7197163 
   11000  0.096171578   -6.8800392   -4.0061746 
   11500  0.090321263   -6.8795246   -3.8740594 
   12000  0.099567559   -6.8795376     -3.85985 
   12500  0.096972068   -6.8805571   -3.7722766 
   13000  0.087604968   -6.8801976   -3.6655684 
   13500  0.091433087   -6.8802444   -3.7954165 
   14000  0.093361673   -6.8790559   -3.9532242 
   14500  0.094739575   -6.8803736   -3.8183324 
   15000   0.11148863    -6.847339   -3.8997684 
   15500   0.10882629   -6.8473743   -3.9389053 
   16000   0.10914464   -6.8473636   -3.6642953 
   16500   0.10354437   -6.8470688   -3.7353858 
   17000   0.10455408   -6.8467459    -3.806479 
   17500   0.10933216   -6.8475443   -3.6770825 
   18000   0.10425443   -6.8478163   -3.8539682 
   18500    0.1085089   -6.8477088   -3.7423814 
   19000   0.11116068   -6.8475029   -3.7449403 
   19500   0.11162558   -6.8470732   -3.9824675 
   20000   0.10109192   -6.8469044   -3.8830848 
   20500   0.10069884   -6.8467707   -3.7898851 
   21000   0.11120897   -6.8478011    -3.683318 
   21500   0.10616299   -6.8466404   -3.7653856 
   22000   0.10525318   -6.8469593    -3.675084 
   22500   0.11186722   -6.8471919   -3.7612857 
   23000   0.10415387    -6.847403   -3.7304329 
   23500   0.10359625    -6.846616   -3.6880118 
   24000   0.10123742   -6.8482256   -3.5227002 
   24500   0.10842561   -6.8476445   -3.8764754 
   25000   0.11218979   -6.8476488   -4.0440112 
   25500   0.10842148   -6.8478609   -3.9948207 
   26000   0.11020158   -6.8476299   -3.9061519 
   26500    0.1016098   -6.8481643   -3.7549831 
   27000   0.10643431   -6.8470576   -3.6356331 
   27500   0.09690535   -6.8477199   -3.7859374 
   28000  0.097619153   -6.8850326   -3.9289445 
   28500   0.10702871   -6.8542935   -3.8775445 
   29000   0.10399457   -6.8546912   -3.7465593 
   29500   0.11386204   -6.8541036   -3.9339326 
   30000  0.097839839   -6.8544154   -3.8687883 
   30500   0.11205459   -6.8546425   -3.9142963 
   31000   0.10806965   -6.8548831   -3.9690062 
   31500  0.098987651   -6.8548095     -3.67867 
   32000   0.10113906   -6.8536993   -3.7582264 
   32500   0.10182209   -6.8544484   -3.8472097 
   33000  0.096975088   -6.8554718   -3.6821768 
   33500   0.10947879   -6.8548578    -3.877718 
   34000   0.10233156   -6.8535388   -3.6980175 
   34500   0.10139577   -6.8837397   -3.9195915 
   35000  0.095278915   -6.8851856   -3.8178746 
   35500  0.084984223   -6.8838963   -3.7265243 
   36000  0.093436728   -6.8843224   -3.7641274 
   36500  0.098028689   -6.8511106   -3.8394435 
   37000   0.10481579   -6.8513574   -3.7438024 
   37500   0.10433554   -6.8510761   -3.8109485 
   38000  0.095696459    -6.851111   -3.7457411 
   38500  0.099698474   -6.8516406   -3.8443874 
   39000  0.098662501   -6.8521369   -3.8657433 
   39500    0.1028499   -6.8520746   -4.0644844 
   40000   0.10696905   -6.8515112   -3.9660554 
   40500   0.10756583   -6.8518546   -3.9956051 
   41000   0.10291497    -6.850662   -3.8494239 
   41500  0.096989921   -6.8517313   -3.7398362 
   42000    0.0960249   -6.8511361   -3.7440981 
   42500   0.10521821   -6.8520645   -3.8190801 
   43000  0.099899397   -6.8516368   -3.7671208 
   43500   0.10306857   -6.8517399   -3.7401319 
   44000   0.10243345   -6.8512552   -3.8403647 
   44500   0.09517131    -6.884212   -3.8333325 
   45000  0.091274505   -6.8839347   -3.7998284 
   45500   0.10736215   -6.8845129   -3.9866935 
   46000  0.096679124   -6.8843951     -3.86941 
   46500  0.093783162   -6.8834432   -3.9324681 
   47000  0.088244904   -6.8838804   -3.7691601 
   47500   0.10081094   -6.8845239   -3.8959354 
   48000  0.090773741   -6.8850035   -3.7670551 
   48500   0.10183643   -6.8838879   -4.0639775 
   49000   0.09005622   -6.8842562   -3.9488105 
   49500  0.090126768    -6.884174   -3.8646715 
   50000   0.09595714   -6.8837635   -3.9541118 
   50500  0.091925309    -6.885067   -3.9108801 
   51000  0.095184285   -6.8842819   -3.8185937 
   51500  0.088323843   -6.8845189    -3.864827 
   52000  0.089316086   -6.8844355   -3.8540607 
   52500  0.095197071   -6.8842493   -3.8378836 
Loop time of 22.3495 on 1 procs for 50000 steps with 125 atoms

Performance: 966464.079 tau/day, 2237.185 timesteps/s
99.6% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.048     | 19.048     | 19.048     |   0.0 | 85.23
Neigh   | 2.0345     | 2.0345     | 2.0345     |   0.0 |  9.10
Comm    | 0.9462     | 0.9462     | 0.9462     |   0.0 |  4.23
Output  | 0.0026443  | 0.0026443  | 0.0026443  |   0.0 |  0.01
Modify  | 0.15359    | 0.15359    | 0.15359    |   0.0 |  0.69
Other   |            | 0.1647     |            |       |  0.74

Nlocal:        125.000 ave         125 max         125 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:        1694.00 ave        1694 max        1694 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:        11915.0 ave       11915 max       11915 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 11915
Ave neighs/atom = 95.320000
Neighbor list builds = 2500
Dangerous builds not checked

compute	p_all all pressure thermo_temp virial

unfix		isokin

thermo_style	custom step temp etotal press c_p_all
#=====Berendsen MD run====#
reset_timestep	0

fix		ave_p all ave/time ${nintervals} ${ave_one} ${prodlength} c_p_all
fix		ave_p all ave/time 40 ${ave_one} ${prodlength} c_p_all
fix		ave_p all ave/time 40 500 ${prodlength} c_p_all
fix		ave_p all ave/time 40 500 20000 c_p_all
unfix	1
fix		1 all nve
fix		2 all temp/berendsen ${temperature} ${temperature}  0.2
fix		2 all temp/berendsen 0.1 ${temperature}  0.2
fix		2 all temp/berendsen 0.1 0.1  0.2

thermo		200

log		log.berendsen.txt
