# Описание
В работе рассматриваются методы расчета коэффициентов переноса. В качестве примера 
рассчитываются коэффициенты самодиффузии и сдвиговой вязкости в леннард-джонсовской 
жидкости.

Коэффициент самодиффузии рассчитывается двумя способами. Первый способ - через 
среднеквадратичные смещения частиц по формуле Эйнштейна-Смолуховского:
```math
D = \lim_{t \to \infty}{\frac{\langle \Delta {\vec r}^2 (t) \rangle}{6t}}.
```

Второй способ - вычисление по формуле Грина-Кубо через автокорреляционную функцию 
скорости (АКФС):
```math
D = \frac{1}{3}\int_0^\infty \langle {\vec v}(t) {\vec v}(t + \tau) \rangle d\tau.
```
Сдвиговая вязкость рассчитывается по формуле Грина-Кубо через автокорреляционную 
функцию сдвиговых напряжений:
```math
\eta = \frac{V}{k_B T}\int_0^\infty \langle P_{xy}(t) P_{xy}(t + \tau) \rangle d\tau,
```
где (мгновенное) сдвиговое напряжение определяется выражением
```math
P_{IJ} = \frac{1}{V}\left( \sum_k^N m_k v_{k,I}v_{k,J} + \sum_k^{N'} r_{k,I}f_{k,J} \right),
```
где $`v_{k,I}`$, $`r_{k,I}`$ и $`f_{k,I}`$ - $`I`$-е компоненты скорости, радиус-вектора 
и силы, действующей на частицу с номером $`k`$, соответственно.

## Процедура расчета
Задача работы - получить оценки коэффициентов самодиффузии и сдвиговой вязкости для 
жидкости и сравнить оценки, получаемые разными методами.

В целях экономии вычислительного времени расчет разбит на несколько этапов:
1. Вывод системы с заданной плотностью на равновесие при заданной температуре и запись конечного состояния в файл.
1. Чтение записанного файла и расчет коэффициента самодиффузии по формуле Эйнштейна-Смолуховского.
1. Чтение записанного файла и расчет коэффициента самодиффузии по формуле Грина-Кубо.
1. Чтение записанного файла и расчет сдвиговой вязкости по формуле Грина-Кубо.

После каждого расчета файл, из которого считывается начальное состояние, перезаписывается 
конечным состоянием расчета.

## Файлы
Входные файлы:
* `in.equilibrate` - подготовка начального состояния для последующих расчетов
* `in.diffusion.msd` - для расчета коэффициента самодиффузии через среднеквадратичное смещение
* `in.diffusion.gk` - для расчета диффузии через АКФС
* `in.viscosity` - для расчета сдвиговой вязкости через автокорреляционную функцию сдвиговых напряжений

Все файлы могут быть запущены с указанием переменных `temp` и `rho`, задающими температуру и плотность 
системы, для которых проводится расчет. Для `in.equilibrate` будет генерироваться соответствующее 
состояние, для остальных файлов будет проводиться поиск файлов с записанным состоянием по этим 
параметрам.

## Запуск
TODO

## Задание
1. Запустить входной файл `in.equilibrate` с параметрами по умолчанию. Чему равны температура и плотность по умолчанию?
1. Запустить файл `in.diffusion.msd`.
1. Построить с помощью Gnuplot график из выходного файла `msd.*.txt`, используя по оси X первый столбец (время), по оси Y - второй (среднеквадратичное смещение).
1. Построить с помощью Gnuplot график из выходного файла `msd.*.txt`, используя по оси X первый столбец (время), по оси Y - третий ($`{\langle \Delta {\vec r}^2 (t)}/(6t)`$).
1. Запустить файл `in.diffusion.gk`.
1. Сравнить коэффициенты диффузии, выводимые двумя методами.
1. Запустить файлы `in.diffusion.msd` и `in.diffusion.gk` несколько раз. Получаются ли идентичные результаты при каждом запуске?
1. Запустить файл `in.viscosity`.
1. Сопоставить полученное значение вязкости с приведенным в литературе $`\eta = 2.6863`$ для температуры 1.5 и плотности 0.85 [R. Khordad / Physica A 387 (2008) 4519–4530].

## Вопросы
TODO